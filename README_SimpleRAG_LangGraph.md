# SimpleRAG with LangGraph

LangGraphλ¥Ό μ‚¬μ©ν•μ—¬ κµ¬ν„ν• SimpleRAG μ‹μ¤ν…μ…λ‹λ‹¤. `FAISSSearchEngine` ν΄λμ¤λ¥Ό μ„ν¬νΈν•μ—¬ κ²€μƒ‰κ³Ό λ‹µλ³€ μƒμ„±μ„ λ¶„λ¦¬λ λ…Έλ“λ΅ κµ¬μ„±ν–μµλ‹λ‹¤.

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

### LangGraph μ›ν¬ν”λ΅μ°
```
μ…λ ¥ μΏΌλ¦¬ β†’ [κ²€μƒ‰ λ…Έλ“] β†’ [μ΅°κ±΄λ¶€ λ¶„κΈ°] β†’ [λ‹µλ³€ μƒμ„± λ…Έλ“] β†’ μµμΆ… λ‹µλ³€
                    β†“
              [μ¤λ¥ μ²λ¦¬ λ…Έλ“]
```

### λ…Έλ“ κµ¬μ„±
1. **κ²€μƒ‰ λ…Έλ“ (search)**: FAISS κ²€μƒ‰ μν–‰
2. **λ‹µλ³€ μƒμ„± λ…Έλ“ (generate_answer)**: LLMμΌλ΅ λ‹µλ³€ μƒμ„±
3. **μ¤λ¥ μ²λ¦¬ λ…Έλ“ (handle_error)**: μ¤λ¥ μƒν™© μ²λ¦¬

## π€ μ‹¤ν–‰ λ°©λ²•

### 1. κΈ°λ³Έ μ‹¤ν–‰
```bash
# κΈ°λ³Έ μ„¤μ • (HuggingFace μ„λ² λ”© + simple ν”„λ΅¬ν”„νΈ)
uv run python simple_rag_langgraph.py

# Gemini μ„λ² λ”© μ‚¬μ©
uv run python simple_rag_langgraph.py gemini

# Gemini μ„λ² λ”© + detailed ν”„λ΅¬ν”„νΈ
uv run python simple_rag_langgraph.py gemini detailed

# Gemini μ„λ² λ”© + academic ν”„λ΅¬ν”„νΈ
uv run python simple_rag_langgraph.py gemini academic
```

### 2. μ‚¬μ© κ°€λ¥ν• ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ

| μ¤νƒ€μΌ | νΉμ§• | μ‚¬μ© μ‹κΈ° |
|--------|------|-----------|
| **simple** | κ°„κ²°ν•κ³  ν•µμ‹¬μ μΈ λ‹µλ³€ | λΉ λ¥Έ μ°Έμ΅° λ° μ”μ•½ |
| **detailed** | μƒμ„Έν•κ³  κµ¬μ΅°ν™”λ λ‹µλ³€ | μΌλ°μ μΈ ν•™μµ λ° μ΄ν•΄ |
| **academic** | ν•™μ μ μ΄κ³  μ²΄κ³„μ μΈ λ‹µλ³€ | μ—°κµ¬ λ° μ „λ¬Έμ  λ¶„μ„ |

## π“ νμΌ κµ¬μ΅°

```
llm_rag_lecture/
β”β”€β”€ simple_rag_langgraph.py          # λ©”μΈ SimpleRAG μ‹μ¤ν…
β”β”€β”€ faiss_search_engine.py           # FAISS κ²€μƒ‰ μ—”μ§„ (μ„ν¬νΈλ¨)
β”β”€β”€ faiss_index_builder.py           # μΈλ±μ¤ κµ¬μ¶• λ„κµ¬
β”β”€β”€ DocumentsLoader/
β”‚   β”β”€β”€ educational_faiss_index/     # FAISS μΈλ±μ¤ μ €μ¥μ†
β”‚   β””β”€β”€ simple_rag_results/          # SimpleRAG κ²°κ³Ό μ €μ¥μ†
β””β”€β”€ README_SimpleRAG_LangGraph.md    # μ΄ νμΌ
```

## π”§ μ£Όμ” κΈ°λ¥

### 1. LangGraph μ›ν¬ν”λ΅μ°
- **μƒνƒ κ΄€λ¦¬**: `RAGState` TypedDictλ΅ μƒνƒ μ •μ
- **λ…Έλ“ λ¶„λ¦¬**: κ²€μƒ‰κ³Ό λ‹µλ³€ μƒμ„±μ„ λ…λ¦½μ μΈ λ…Έλ“λ΅ κµ¬μ„±
- **μ΅°κ±΄λ¶€ λ¶„κΈ°**: κ²€μƒ‰ μ„±κ³µ/μ‹¤ν¨μ— λ”°λ¥Έ λ¶„κΈ° μ²λ¦¬
- **μ¤λ¥ μ²λ¦¬**: μ „μ© μ¤λ¥ μ²λ¦¬ λ…Έλ“

### 2. FAISS κ²€μƒ‰ μ—”μ§„ ν†µν•©
- `FAISSSearchEngine` ν΄λμ¤ μ„ν¬νΈ
- HNSW μΈλ±μ¤ ν™μ©
- μ μ‚¬λ„ κ²€μƒ‰ λ° κ²°κ³Ό μ •λ ¬

### 3. LLM ν†µν•©
- Gemini 2.5 Flash λ¨λΈ μ‚¬μ©
- λ‹¤μ–‘ν• ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ μ§€μ›
- ChatPromptTemplate ν™μ©

### 4. κ²°κ³Ό μ €μ¥
- JSON ν•νƒλ΅ κ²°κ³Ό μ €μ¥
- λ©”νƒ€λ°μ΄ν„° ν¬ν•¨ (μ„λ² λ”© νƒ€μ…, LLM λ¨λΈ, ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ λ“±)
- νƒ€μ„μ¤νƒ¬ν”„ μλ™ μƒμ„±

## π’» μ‚¬μ© μμ‹

### λ€ν™”ν• λ¨λ“
```bash
$ uv run python simple_rag_langgraph.py gemini simple

π¤– SimpleRAG with LangGraph
   β€Ά μ„λ² λ”© λ¨λΈ: gemini
   β€Ά ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ: simple
   β€Ά μ›ν¬ν”λ΅μ° μ—”μ§„: LangGraph

π¤– SimpleRAG λ€ν™”ν• λ¨λ“
============================================================
μ‚¬μ© κ°€λ¥ν• λ…λ Ήμ–΄:
  - μ§λ¬Έλ§ μ…λ ¥: μ§μ ‘ μ§λ¬Έ (μ: 'RSIλ€ λ¬΄μ—‡μΈκ°€μ”?', 'λ³Όλ¦°μ €λ°΄λ“ μ‚¬μ©λ²•')
  - 'ask <μ§λ¬Έ>': λ…μ‹μ  μ§λ¬Έ λ…λ Ή
  - 'info': μ‹μ¤ν… μ •λ³΄
  - 'quit': μΆ…λ£

ν„μ¬ μ„¤μ •:
  β€Ά μ„λ² λ”©: gemini
  β€Ά LLM: Gemini 2.5 Flash
  β€Ά ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ: simple
  β€Ά μ›ν¬ν”λ΅μ°: LangGraph

μ§λ¬Έ μ…λ ¥: RSIλ€ λ¬΄μ—‡μΈκ°€μ”?
```

### μ›ν¬ν”λ΅μ° μ‹¤ν–‰ κ³Όμ •
```
π” κ²€μƒ‰ λ…Έλ“ μ‹¤ν–‰: 'RSIλ€ λ¬΄μ—‡μΈκ°€μ”?'
π¤– λ‹µλ³€ μƒμ„± λ…Έλ“ μ‹¤ν–‰

π¤– λ‹µλ³€:
----------------------------------------
RSIλ” μƒλ€κ°•λ„μ§€μ(Relative Strength Index)λ΅...

π“„ μ°Έκ³  λ¬Έμ„ (3κ°):
   1. νμ΄μ§€ 15 (μ μ‚¬λ„: 0.8923)
   2. νμ΄μ§€ 23 (μ μ‚¬λ„: 0.7845)
   3. νμ΄μ§€ 31 (μ μ‚¬λ„: 0.7234)
```

## π” LangGraph vs κΈ°μ΅΄ RAG μ‹μ¤ν…

### LangGraphμ μ¥μ 
1. **λ¨λ“ν™”**: κ²€μƒ‰κ³Ό λ‹µλ³€ μƒμ„±μ„ λ…λ¦½μ μΈ λ…Έλ“λ΅ λ¶„λ¦¬
2. **ν™•μ¥μ„±**: μƒλ΅μ΄ λ…Έλ“λ‚ μ΅°κ±΄λ¶€ λ¶„κΈ° μ‰½κ² μ¶”κ°€ κ°€λ¥
3. **μƒνƒ κ΄€λ¦¬**: TypedDictλ΅ λ…ν™•ν• μƒνƒ μ •μ
4. **μ¤λ¥ μ²λ¦¬**: μ „μ© μ¤λ¥ μ²λ¦¬ λ…Έλ“λ΅ κ²¬κ³ ν• μ‹μ¤ν…
5. **μ‹κ°ν™”**: μ›ν¬ν”λ΅μ° κµ¬μ΅°λ¥Ό λ…ν™•ν•κ² νμ•… κ°€λ¥

### κΈ°μ΅΄ RAG μ‹μ¤ν…κ³Όμ μ°¨μ΄μ 
| κµ¬λ¶„ | κΈ°μ΅΄ RAG | LangGraph RAG |
|------|----------|---------------|
| κµ¬μ΅° | λ‹¨μΌ ν•¨μ | λ…Έλ“ κΈ°λ° μ›ν¬ν”λ΅μ° |
| ν™•μ¥μ„± | μ ν•μ  | λ†’μ |
| μ¤λ¥ μ²λ¦¬ | try-catch | μ „μ© λ…Έλ“ |
| μƒνƒ κ΄€λ¦¬ | λ³€μ | TypedDict |
| λ””λ²„κΉ… | μ–΄λ ¤μ›€ | μ‰¬μ›€ |

## π› οΈ μ‹μ¤ν… μ„¤μ •

### ν™κ²½ λ³€μ
```bash
# .env νμΌ
GOOGLE_API_KEY=your_gemini_api_key_here
```

### μμ΅΄μ„± ν¨ν‚¤μ§€
```toml
# pyproject.toml
langgraph = "^0.2.0"
langchain = "^0.3.0"
langchain-google-genai = "^2.0.0"
langchain-community = "^0.3.0"
faiss-cpu = "^1.7.4"
sentence-transformers = "^3.0.0"
python-dotenv = "^1.0.0"
```

## π“ μ„±λ¥ μµμ ν™”

### 1. κ²€μƒ‰ μµμ ν™”
- HNSW efSearch νλΌλ―Έν„° μ΅°μ •
- κ²€μƒ‰ κ²°κ³Ό μ (k) μµμ ν™”
- μ„λ² λ”© λ¨λΈ μ„ νƒ

### 2. LLM μµμ ν™”
- ν”„λ΅¬ν”„νΈ μ¤νƒ€μΌ μ„ νƒ
- temperature μ΅°μ •
- max_output_tokens μ„¤μ •

### 3. μ›ν¬ν”λ΅μ° μµμ ν™”
- λ…Έλ“ κ°„ λ°μ΄ν„° μ „λ‹¬ μµμ ν™”
- λ¶ν•„μ”ν• μƒνƒ μ—…λ°μ΄νΈ μ κ±°
- λ©”λ¨λ¦¬ μ‚¬μ©λ‰ λ¨λ‹ν„°λ§

## π”§ λ¬Έμ  ν•΄κ²°

### 1. LangGraph κ΄€λ ¨ μ¤λ¥
```bash
# LangGraph μ„¤μΉ ν™•μΈ
uv add langgraph

# λ²„μ „ νΈν™μ„± ν™•μΈ
uv list | grep langgraph
```

### 2. FAISS μΈλ±μ¤ λ΅λ“ μ¤λ¥
```bash
# μΈλ±μ¤ νμΌ μ΅΄μ¬ ν™•μΈ
ls DocumentsLoader/educational_faiss_index/

# μΈλ±μ¤ μ¬κµ¬μ¶•
uv run python faiss_index_builder.py
```

### 3. API ν‚¤ μ¤λ¥
```bash
# ν™κ²½ λ³€μ ν™•μΈ
echo $GOOGLE_API_KEY

# .env νμΌ ν™•μΈ
cat .env
```

## π― ν–¥ν›„ κ°μ„  λ°©ν–¥

1. **λ‹¤μ¤‘ κ²€μƒ‰ λ…Έλ“**: λ‹¤μ–‘ν• κ²€μƒ‰ λ°©λ²• ν†µν•©
2. **λ‹µλ³€ κ²€μ¦ λ…Έλ“**: μƒμ„±λ λ‹µλ³€μ ν’μ§ κ²€μ¦
3. **μ‚¬μ©μ ν”Όλ“λ°± λ…Έλ“**: μ‚¬μ©μ ν”Όλ“λ°± μμ§‘ λ° ν•™μµ
4. **μΊμ‹± λ…Έλ“**: μμ£Ό λ¬»λ” μ§λ¬Έ μΊμ‹±
5. **λ΅κΉ… λ…Έλ“**: μƒμ„Έν• μ‹¤ν–‰ λ΅κ·Έ μμ§‘

## π“ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” κµμ΅ λ©μ μΌλ΅ μ μ‘λμ—μµλ‹λ‹¤.

---

**μ°Έκ³ **: μ΄ μ‹μ¤ν…μ„ μ‚¬μ©ν•κΈ° μ „μ— `faiss_index_builder.py`λ¥Ό μ‹¤ν–‰ν•μ—¬ FAISS μΈλ±μ¤λ¥Ό λ¨Όμ € κµ¬μ¶•ν•΄μ•Ό ν•©λ‹λ‹¤. 